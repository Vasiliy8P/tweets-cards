"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[114],{114:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var r=n(433),s=n(439),o=n(791),a=n(689),c=n(87),u=n(984),i=n(861),l=n(757),f=n.n(l),d=n(243);d.Z.defaults.baseURL="https://640d0e31b07afc3b0da6e662.mockapi.io";var w=function(){var e=(0,i.Z)(f().mark((function e(t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.get("/tweets?page=".concat(t,"&limit=3"));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,i.Z)(f().mark((function e(t,n){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.put("/tweets/".concat(t),{followers:n+1});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=(0,i.Z)(f().mark((function e(t,n){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Z.put("/tweets/".concat(t),{followers:n-1});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=n(184),g=function(e){var t=e.tweet,n=t.user,r=t.tweets,s=t.followers,o=t.id,a=e.followingTweetsId,c=e.onClickFollowing;return(0,m.jsx)("div",{className:"TweetCard",children:(0,m.jsxs)("div",{className:"TweetCard__container",children:[(0,m.jsx)("div",{className:"TweetCard__header",children:(0,m.jsx)("img",{className:"TweetCard__logo",src:"logo",alt:"logo"})}),(0,m.jsxs)("div",{className:"TweetCard__user",children:[(0,m.jsx)("p",{children:n}),(0,m.jsx)("img",{className:"TweetCard__user-photo",src:"user",alt:"user"})]}),(0,m.jsxs)("div",{className:"TweetCard__tweets-info",children:[(0,m.jsxs)("p",{className:"TweetCard__tweets-counter",children:[" ",r," TWEETS"]}),(0,m.jsxs)("p",{className:"TweetCard__followers-counter",children:[" ",s," FOLLOWERS"]}),(0,m.jsx)("button",{className:a.includes(o)?"TweetCard__btn-following":"TweetCard__btn-follow",type:"button",onClick:function(){return c(o,s)},children:a.includes(o)?"following":"Follow"})]})]})})},_=n(643),x=function(){return(0,m.jsx)(_.g4,{height:"80",width:"80",radius:"9",color:"#4B2A99",ariaLabel:"three-dots-loading",wrapperStyle:{marginLeft:"auto",marginRight:"auto"},wrapperClassName:"",visible:!0})},v=function(){var e,t,n=(0,o.useState)([]),i=(0,s.Z)(n,2),l=i[0],f=i[1],d=(0,o.useState)(1),_=(0,s.Z)(d,2),v=_[0],b=_[1],T=(0,o.useState)(function(){var e=localStorage.getItem("followingTweets");return null!==e?JSON.parse(e):[]}()),j=(0,s.Z)(T,2),k=j[0],C=j[1],N=(0,o.useState)(null),Z=(0,s.Z)(N,2),S=Z[0],y=Z[1],L=null!==(e=null===(t=(0,a.TH)().state)||void 0===t?void 0:t.from)&&void 0!==e?e:"/";(0,o.useEffect)((function(){y(!0),w(v).then((function(e){f((function(t){return[].concat((0,r.Z)(t),(0,r.Z)(e))})),y(!1)})).catch((function(e){return console.log(e.message)}))}),[v]),(0,o.useEffect)((function(){localStorage.setItem("followingTweets",JSON.stringify(k))}));var E=function(e,t){if(!k.includes(e))return C((function(t){return[].concat((0,r.Z)(t),[e])})),void function(e,t){p(e,t).then((function(e){f((function(t){return t.map((function(t){return t.id===e.id&&(t.followers=e.followers),t}))}))})).catch((function(e){return console.log(e.message)}))}(e,t);C((function(t){return(0,r.Z)(t.filter((function(t){return t!==e})))})),function(e,t){h(e,t).then((function(e){f((function(t){return t.map((function(t){return t.id===e.id&&(t.followers=e.followers),t}))}))})).catch((function(e){return console.log(e.message)}))}(e,t)};return(0,m.jsxs)(m.Fragment,{children:["  ",(0,m.jsx)(c.rU,{to:L,className:"Tweets-list__btn-back-link",children:(0,m.jsx)("button",{className:"Tweets-list__btn-back",type:"button",children:"Back"})}),(0,m.jsx)("ul",{className:"Tweets-list",children:S?(0,m.jsx)(x,{}):l.map((function(e){return(0,m.jsx)("li",{className:"Tweets-list__item",children:(0,m.jsx)(g,{tweet:e,onClickFollowing:E,followingTweetsId:k})},(0,u.x0)())}))}),l.length>0&&!S&&(0,m.jsx)("button",{className:"Tweets-list__btn-LoadMore",type:"button",onClick:function(){b((function(e){return e+1}))},children:"Load more"})]})}}}]);
//# sourceMappingURL=114.42820f6b.chunk.js.map